<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Speech Synthesis Test</title>
</head>
<body>
  <h1>Speech Synthesis Test</h1>
  <p>Type something below and click "Speak".</p>

  <textarea id="text" rows="4" cols="50">Hello, this is a speech synthesis test.</textarea><br><br>
  <button onclick="speakText()">Speak</button>

  <script>
    function speakText() {
      const text = document.getElementById('text').value;

      if (!('speechSynthesis' in window)) {
        alert("Sorry, your browser does not support speech synthesis.");
        return;
      }

      const voices = speechSynthesis.getVoices();

      if (voices.length === 0) {
        alert("Voices not loaded yet. Try refreshing the page.");
        return;
      }

      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'en-US';
      utterance.volume = 1;
      utterance.rate = 1;
      utterance.pitch = 1;

      const voice = voices.find(v => v.lang === 'en-US' && v.name.includes("Google")) 
                  || voices.find(v => v.lang === 'en-US');
      if (voice) {
        utterance.voice = voice;
        console.log("Using voice:", voice.name);
      } else {
        console.warn("No suitable voice found.");
      }

      speechSynthesis.speak(utterance);
    }

    // Make sure voices load before use
    window.speechSynthesis.onvoiceschanged = () => {
      console.log("Voices loaded:", speechSynthesis.getVoices());
    };
  </script>
</body>
</html>
